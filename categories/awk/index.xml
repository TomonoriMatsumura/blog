<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>awk on Mainroad</title><link>https://tomonorimatsumura.github.io/blog/categories/awk/</link><description>Recent content in awk on Mainroad</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 22 Apr 2017 14:43:51 +0000</lastBuildDate><atom:link href="https://tomonorimatsumura.github.io/blog/categories/awk/index.xml" rel="self" type="application/rss+xml"/><item><title>Historyコマンドからコマンド利用頻度を調べる</title><link>https://tomonorimatsumura.github.io/blog/p1293/</link><pubDate>Sat, 22 Apr 2017 14:43:51 +0000</pubDate><guid>https://tomonorimatsumura.github.io/blog/p1293/</guid><description>history | awk &amp;quot;{print $2}&amp;quot; | sort | uniq -c | sort -n -r -k1</description></item><item><title>Dockerでコンテナの名前を調べる</title><link>https://tomonorimatsumura.github.io/blog/p1106/</link><pubDate>Sat, 19 Dec 2015 19:05:22 +0000</pubDate><guid>https://tomonorimatsumura.github.io/blog/p1106/</guid><description>Dockerにコンテナ名だけ表示するコマンドがないのでawkを使う
docker ps | awk &amp;quot;NR == 2 {print $NF}&amp;quot; # NR == 2は2行目、$NFは最後の列</description></item><item><title>awkでSSHアクセス履歴を調べる</title><link>https://tomonorimatsumura.github.io/blog/p1080/</link><pubDate>Tue, 17 Nov 2015 13:18:29 +0000</pubDate><guid>https://tomonorimatsumura.github.io/blog/p1080/</guid><description>SSHのアクセスログを定期的に調べる必要がある。
ログインが成功したアクセスを調べる # アクセスが成功したログインを全て表示する grep &amp;quot;Accepted&amp;quot; /var/log/secure* # もしくは grep &amp;quot;Accepted&amp;quot; /var/log/secure* | awk &amp;quot;{split($1, arr, &amp;quot;:&amp;quot;); print arr[2] $2 &amp;quot; &amp;quot; $3 &amp;quot; &amp;quot; $9 &amp;quot; &amp;quot; $11}&amp;quot; # 順にホワイトリストを当ててみて不正アクセスが無いか確認する # 188.251.* はauのテザリング端末 # 221.1.36.239は自宅のインターネットプロバイダ # 133.xxx.xxx.xxxは契約しているVPSサーバ grep &amp;quot;Accepted&amp;quot; /var/log/secure* | awk &amp;quot;{print $9 &amp;quot; &amp;quot; $11}&amp;quot; | awk &amp;quot;{sub(&amp;quot;/182.251.*/&amp;quot;, &amp;quot;&amp;quot;); print $0;}&amp;quot; | awk &amp;quot;{sub(&amp;quot;222.1.36.239&amp;quot;, &amp;quot;&amp;quot;); print $0;}&amp;quot; | awk &amp;quot;{sub(&amp;quot;133.xxx.xxx.xxx&amp;quot;, &amp;quot;&amp;quot;); print $0;}&amp;quot; ログインが失敗したアクセスを調べる grep -E &amp;quot;Failed|Invalid&amp;quot; /var/log/secure* 参考サイト アクセスログ解析（ssh編） | tkd55 blog</description></item><item><title>awkでファイル名とファイルサイズを表示する</title><link>https://tomonorimatsumura.github.io/blog/p961/</link><pubDate>Mon, 15 Dec 2014 11:01:13 +0000</pubDate><guid>https://tomonorimatsumura.github.io/blog/p961/</guid><description>ローカルPCからサーバPCにアップロードした複数のファイルがデータ欠損無くアップロードされたか調べる必要があった。
awkコマンド スペースや文字列を入れる際は『””』で文字列を挿入できる。
ls -l | awk &amp;quot;{print $5 &amp;quot; &amp;quot; $10}&amp;quot; # 表示結果 3428352 2012-03-31_092749.m2ts 603678720 2012-03-31_092950.m2ts 110862336 2012-03-31_093642.m2ts 501264384 2012-03-31_094907.m2ts 76351488 2012-03-31_095537.m2ts 72603648 2012-03-31_121637.m2ts 240248832 2012-03-31_122300.m2ts 47290368 2012-03-31_123804.m2ts 28962816 2012-03-31_123949.m2ts 283367424 2012-03-31_124153.m2ts 758593536 2012-03-31_124918.m2ts 41908224 2012-03-31_125810.m2ts 46276608 2012-03-31_130644.m2ts 233484288 2012-03-31_131012.m2ts 45594624 2012-03-31_132639.m2ts 427788288 2012-03-31_133014.m2ts 53962752 2012-03-31_140503.m2ts 183214080 2012-03-31_140755.m2ts 240199680 2012-03-31_142430.m2ts 85438464 2012-03-31_142707.m2ts 39942144 2012-03-31_143018.m2ts 222339072 2012-03-31_143047.m2ts 508059648 2012-03-31_143417.m2ts 11550720 2012-03-31_144018.m2ts 58619904 2012-03-31_144110.m2ts 63449088 2012-03-31_144544.m2ts 20779008 2012-03-31_144638.m2ts 28760064 2012-03-31_144839.m2ts 140064768 2012-03-31_144903.</description></item></channel></rss>