<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Python on Mainroad</title><link>https://tomonorimatsumura.github.io/blog/categories/python/</link><description>Recent content in Python on Mainroad</description><generator>Hugo -- gohugo.io</generator><language>ja</language><lastBuildDate>Tue, 14 Feb 2017 10:48:26 +0000</lastBuildDate><atom:link href="https://tomonorimatsumura.github.io/blog/categories/python/index.xml" rel="self" type="application/rss+xml"/><item><title>Seleniumでコマンドラインでページソースを取得する</title><link>https://tomonorimatsumura.github.io/blog/p1223/</link><pubDate>Tue, 14 Feb 2017 10:48:26 +0000</pubDate><guid>https://tomonorimatsumura.github.io/blog/p1223/</guid><description>Selenium、Pythonの設定方法は『CentOS7にSeleniuimをインストールする』を参考にする。
スクリプトの書き方 import sys import os import codecs from pyvirtualdisplay import Display from selenium import webdriver from selenium.webdriver.common.desired_capabilities import DesiredCapabilities display = Display(visible=0, size=(1024, 768)) display.start() args = sys.argv url = args[1] save_dir = args[2] file_name = args[3] firefox_capabilities = DesiredCapabilities.FIREFOX firefox_capabilities[&amp;quot;marionette&amp;quot;] = True firefox_capabilities[&amp;quot;binary&amp;quot;] = &amp;quot;/usr/bin/firefox&amp;quot; driver = webdriver.Firefox(capabilities=firefox_capabilities) driver.get(url) html = driver.page_source completeName = os.path.join(save_dir, file_name) file_object = codecs.open(completeName, &amp;quot;w&amp;quot;, &amp;quot;utf-8&amp;quot;) file_object.write(html) file_object.close() print driver.title driver.close() スクリプトを実行する # python script_file url file_dir file_name python get_page_title_by_cli.</description></item><item><title>Seleniumでコマンドラインでページタイトルを取得する</title><link>https://tomonorimatsumura.github.io/blog/p1216/</link><pubDate>Tue, 14 Feb 2017 10:11:31 +0000</pubDate><guid>https://tomonorimatsumura.github.io/blog/p1216/</guid><description>Selenium、Pythonの設定方法は『CentOS7にSeleniuimをインストールする』を参考にする
スクリプトの書き方 import sys from selenium import webdriver from selenium.webdriver.common.keys import Keys from selenium.webdriver.common.desired_capabilities import DesiredCapabilities from pyvirtualdisplay import Display display = Display(visible=0, size=(1024, 768)) display.start() args = sys.argv url = args[1] firefox_capabilities = DesiredCapabilities.FIREFOX firefox_capabilities[&amp;quot;marionette&amp;quot;] = True firefox_capabilities[&amp;quot;binary&amp;quot;] = &amp;quot;/usr/bin/firefox&amp;quot; driver = webdriver.Firefox(capabilities=firefox_capabilities) driver.get(url) print driver.title print url driver.close() スクリプトを実行する python get_page_title_by_cli.py http://yahoo.co.jp # 実行結果 Yahoo! JAPAN http://yahoo.co.jp</description></item><item><title>CentOS7でSeleniumをDockerコンテナで利用する</title><link>https://tomonorimatsumura.github.io/blog/p1206/</link><pubDate>Sat, 28 Jan 2017 13:33:06 +0000</pubDate><guid>https://tomonorimatsumura.github.io/blog/p1206/</guid><description>DockerをインストールしFirefoxコンテナを立ち上げる yum install docker systemctl start docker sytemctl enable docker docker run -d -p 4444:4444 selenium/standalone-firefox:latest Python Seleniumをインストールする yum install epel-release yum install python-pip pip install --upgrade pip pip install selenium DockerコンテナのIPアドレスを取得する 接続先のDockerコンテナのIPアドレスを指定しないとコンテナに接続出来ない。テストスクリプトにIPアドレスを記述するために取得する。
docker ps | awk &amp;quot;NR&amp;amp;gt;1&amp;amp;&amp;amp;$0=$1&amp;quot; | xargs -n 1 docker inspect -f &amp;quot;{{.Name}} {{.NetworkSettings.IPAddress }}&amp;quot; テストスクリプト例 from selenium import webdriver from selenium.webdriver.common.desired_capabilities import DesiredCapabilities firefox_capabilities = DesiredCapabilities.FIREFOX driver = webdriver.Remote( command_executor=&amp;quot;http://127.17.0.2:4444/wd/hub&amp;quot;, desired_capabilities=firefox_capabilities) driver.get(&amp;quot;http://yahoo.co.jp&amp;quot;) print driver.title driver.close() 参考サイト CentOS7 で Docker を使ってみる – CUBE SUGAR CONTAINER 稼働中のdockerコンテナのIPアドレス一覧を取得する – くんすとの備忘録 2.</description></item><item><title>CentOS7にSeleniuimをインストールする</title><link>https://tomonorimatsumura.github.io/blog/p1201/</link><pubDate>Sun, 18 Dec 2016 14:52:57 +0000</pubDate><guid>https://tomonorimatsumura.github.io/blog/p1201/</guid><description>Pipをインストールする yum install epel-release yum install python-pip pip install --upgrade pip Xvfbをインストールする ブラウザを立ち上げずにSeleniumを操作するのに必要なライブラリをインストールする
yum -y install xorg-x11-server-Xvfb pip install pyvirtualdisplay SeleniumとFirefoxをインストールする SeleniumからFirefoxを操作するにはGeckodriverをインストールする。他のブラウザを利用する時でも何らかのドライバをインストールする必要がありそうだ。
curl -O -L https://github.com/mozilla/geckodriver/releases/download/v0.11.1/geckodriver-v0.11.1-linux64.tar.gz tar fzxv geckodriver-v0.11.1-linux64.tar.gz mv geckodriver /usr/local/bin/ pip install selenium yum install firefox テストスクリプト例 CLI環境でスクリプトを実行する場合は必ずVirtualDisplayを経由させる。geckodriverがエラーで立ち上がらない。
from selenium import webdriver from selenium.webdriver.common.keys import Keys from selenium.webdriver.common.desired_capabilities import DesiredCapabilities from pyvirtualdisplay import Display display = Display(visible=0, size=(1024, 768)) display.start() firefox_capabilities = DesiredCapabilities.FIREFOX firefox_capabilities[&amp;quot;marionette&amp;quot;] = True firefox_capabilities[&amp;quot;binary&amp;quot;] = &amp;quot;/usr/bin/firefox&amp;quot; driver = webdriver.</description></item></channel></rss>