---
title: ローカルで作成したGitリポジトリをリモートへプッシュする
author: tomonori
type: post
date: 2013-01-27T11:31:02+00:00
url: /?p=640
categories:
  - Git

---
Gitリポジトリの初期化の時に、共有オプションを有効にしないと以下のようなエラーがでる。

```:bash
remote: error: refusing to update checked out branch: refs/heads/master
remote: error: By default, updating the current branch in a non-bare repository
remote: error: is denied, because it will make the index and work tree inconsistent
remote: error: with what you pushed, and will require "git reset --hard" to match
remote: error: the work tree to HEAD.
remote: error: 
remote: error: You can set "receive.denyCurrentBranch" configuration variable to
remote: error: "ignore" or "warn" in the remote repository to allow pushing into
remote: error: its current branch; however, this is not recommended unless you
remote: error: arranged to update its work tree to match what you pushed in some
remote: error: other way.
remote: error: 
remote: error: To squelch this message and still keep the default behaviour, set
remote: error: "receive.denyCurrentBranch" configuration variable to "refuse".
```

### リモートにGitリポジトリを作成する

共有リポジトリを作成するにはオプションを設定する

```:bash
mkdir git-repo
cd git-repo
git init --bare --shared
```

### ローカルリポジトリをリモートにPUSHする

一番最初にPUSHするときは**&#8211;mirrorオプション**を有効にする

```:bash
cd git-repo
git push --mirror ssh://{user}@{yourdomain}:{port}/var/git/{git-repo}
```

<del datetime="2013-04-29T04:44:58+00:00">SSHのポート番号を変更している場合は『<b>/etc/ssh/ssh_config</b>』でポート番号の設定を変更しておく。</del>

### ローカルにリモートリポジトリをCLONEする

初期設定だとSSHで取得することになっている。ローカルでリモートリポジトリを取得するには

```:bash
# リポジトリをダウンロードするディレクトリに移動
cd /repodir
git clone ssh://{user}@{yourdomain}:{port}/var/git/{git-repo}
```

### 参考サイト

  * [Gitの使い方 &#8211; SourceForge.JP ヘルプ &#8211; SourceForge.JP][1] 
      * [Gitリポジトリにポートを指定してSSHで接続する &#8211; gom68の日記][2] </ul>

 [1]: http://sourceforge.jp/docs/Git%E3%81%AE%E4%BD%BF%E3%81%84%E6%96%B9
 [2]: http://gom.hatenablog.com/entry/20080907/1220767941