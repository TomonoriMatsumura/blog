---
title: CentOS7にFTPサーバを構築する
author: tomonori
type: post
date: 2015-11-08T10:41:11+00:00
url: /?p=1067
categories:
  - CentOS7
  - FTP

---
### vsftpdを導入する

```:bash
# vsftpdをyumでインストールする
yum install vsftpd

# サービスの自動設定を行う
systemctl start vsftpd
systemctl enable vsftpd

systemctl status vsftpd.service # 確認
systemctl is-enabled vsftpd.service # 確認

# アクセス制限の設定を行う

# パケットフィルタリングの設定を行う
firewall-cmd --permanent --add-service=ftp
firewall-cmd --reload
```

### vsftpdの動作設定を行う

#### chrootを設定するのみ

```:bash
chroot_local_user=YES
allow_writeable_chroot=YES
```

#### 詳細設定

```:bash
# 匿名ログイン禁止
anonymous_enable=NO

# アスキーモードでの転送を許可
ascii_upload_enable=YES
ascii_download_enable=YES

# chroot有効
chroot_local_user=YES
chroot_list_enable=YES

# chroot リストファイル指定
chroot_list_file=/etc/vsftpd/chroot_list

# ディレクトリごと一括での転送有効
ls_recurse_enable=YES

# IPv4をリスンする
listen=YES

# IPv6 はリスンしない
listen_ipv6=NO

# 最終行へ追記
# ルートディレクトリ指定 (指定しない場合はホームディレクトリがルートディレクトリとなる)
local_root=public_html

# ローカルタイムを使う
use_localtime=YES

# seccomp filter をオフにする ( ログインに失敗する場合はオフにする )
seccomp_sandbox=NO

# ユーザ個別設定ファイルの配置設定
user_config_dir=/etc/vsftpd/vsftpd_user_conf

# 通常だとユーザーのホームディレクトリ以外にはchroot設定は行えない
# ホームディレクトリ以外でもchroot設定が有効になるようにする
allow_writeable_chroot=YES
```

```:bash
# ユーザーのchrootディレクトリを設定する
mkdir /etc/vsftpd/vsftpd_user_conf

vi /etc/vsftpd/vsftpd_user_conf/ftp-user
local_root=/var/ftp

chowm -R ftp-user:ftp-user /var/ftp

# とりあえず作成する
vi /etc/vsftpd/chroot_list

ftp-user
```

### 参考サイト

  * [CentOS 7 : Vsftpd : インストール ： Server World](http://CentOS 7 : Vsftpd : インストール ： Server World)
  * [[Linux] chroot_list と user_list による権限管理｜vsftpd -スグラボ-](http://blog.sugulab.com/?p=1635)
  * [vsftpdでchrootの設定を行うには。 &#8211; 春木屋](http://d.hatena.ne.jp/flageo/20081219/p1)
  * [vsftpdを設定した &#8211; Qiita](http://qiita.com/tukiyo3/items/5360e74eff80c894dfae)
  * [\[CentOS\]\[vsftpd\]ログインユーザ毎に個別の設定ファイルを適用する | ごった煮 &#8211; tips about programming and building a serve][1]
  * [Ubuntu日本語フォーラム / vsftpdでアップロードを可能にしつつchrootをする方法について](https://forums.ubuntulinux.jp/viewtopic.php?id=16644)

 [1]: http://park1.wakwak.com/~ima/centos4_vsftpd0005.html